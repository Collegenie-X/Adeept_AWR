# 🚗 고등학생을 위한 간단한 자율 주행차 가이드

## 📚 목차
1. [프로그램 소개](#-프로그램-소개)
2. [파일 구조](#-파일-구조)
3. [빠른 시작](#-빠른-시작)
4. [각 모듈 설명](#-각-모듈-설명)
5. [설정 변경하기](#-설정-변경하기)
6. [문제 해결](#-문제-해결)
7. [응용 프로젝트](#-응용-프로젝트)

---

## 🎯 프로그램 소개

이 프로그램은 **고등학생도 쉽게 이해할 수 있도록** 만든 자율 주행차입니다!

### ✨ 주요 기능
- 🛣️ **라인 추적**: 검은 선을 따라갑니다
- 🛡️ **장애물 회피**: 앞의 장애물을 피합니다
- 🧠 **똑똑한 주행**: 두 기능을 합쳐서 안전하게 운전합니다
- 🎮 **수동 조종**: 키보드로 직접 조종할 수 있습니다

### 🔧 기술적 특징
- **모듈화**: 기능별로 파일을 나누어 이해하기 쉽게 구성
- **단순화**: 복잡한 수학이나 알고리즘 없이 간단한 if문만 사용
- **주석**: 모든 함수와 중요한 부분에 한글 설명 추가
- **테스트**: 각 기능을 안전하게 테스트할 수 있는 함수 제공

---

## 📁 파일 구조

```
간단한 자율 주행차 (simple_car 폴더)/
├── ultra_simple_car.py              ← 🎯 기본 버전
├── ultra_simple_car_v2_easy.py      ← 🎓 단계별 학습 버전 (시간 제한)
├── ultra_simple_car_v3.py           ← 🧠 로터리 감지 버전 (기본)
├── ultra_simple_car_v3_improved.py  ← 🌟 개선된 로터리 감지 (최신)
├── simple_sensors.py                ← 📡 센서 읽기
├── simple_motors.py                 ← 🚗 바퀴 움직이기
├── simple_line_follow.py            ← 🛣️ 라인 추적
├── simple_obstacle_avoid.py         ← 🛡️ 장애물 회피
├── simple_car.py                    ← 📚 통합 메뉴 버전
└── HIGH_SCHOOL_GUIDE.md             ← 📚 이 가이드
```

### 📋 각 파일의 역할

| 파일 | 역할 | 추천 대상 | 중요도 |
|------|------|----------|--------|
| `ultra_simple_car.py` | 기본 라인 추적 + 장애물 회피 | 초보자 | ⭐⭐⭐ |
| `ultra_simple_car_v2_easy.py` | 단계별 학습 (자동 종료) | 교육용 | ⭐⭐⭐ |
| `ultra_simple_car_v3.py` | 기본 로터리 감지 추가 | 중급자 | ⭐⭐ |
| `ultra_simple_car_v3_improved.py` | **개선된 로터리 감지 (최신)** | **고급자** | ⭐⭐⭐ |
| `simple_car.py` | 통합 메뉴 버전 | 실험용 | ⭐⭐ |
| `simple_sensors.py` | 라인 센서, 초음파 센서 읽기 | 모든 버전 | ⭐⭐⭐ |
| `simple_motors.py` | 모터 제어 (개별 속도 설정) | 모든 버전 | ⭐⭐⭐ |

---

## 🚀 빠른 시작

### 📚 **추천 학습 순서**

#### 🎯 **1단계: 기본 버전 (초보자)**
```bash
python3 ultra_simple_car.py
```
- 기본 라인 추적 + 장애물 회피
- 가장 간단하고 이해하기 쉬움

#### 🎓 **2단계: 교육 버전 (단계별 학습)**
```bash
python3 ultra_simple_car_v2_easy.py
```
- Step 1, 2, 3 단계별 학습
- 각 단계가 자동으로 종료되어 메뉴로 복귀

#### 🌟 **3단계: 최신 버전 (고급 기능)**
```bash
python3 ultra_simple_car_v3_improved.py
```
- **개선된 3중 로터리 감지 알고리즘**
- 연속 같은 방향 감지
- 실시간 분석 결과 표시

### 🏆 **추천 실행 순서**
1. `ultra_simple_car.py` → 기본 이해
2. `ultra_simple_car_v2_easy.py` → 단계별 학습  
3. `ultra_simple_car_v3_improved.py` → 고급 기능 체험

---

## 🧩 각 모듈 설명

### 📡 simple_sensors.py - 센서 읽기

#### 🔍 주요 함수
- `read_line()`: 라인이 어디에 있는지 확인
  - `"left"`: 라인이 왼쪽에 있음 → 오른쪽으로 가야 함
  - `"center"`: 라인이 가운데 있음 → 직진
  - `"right"`: 라인이 오른쪽에 있음 → 왼쪽으로 가야 함
  - `"none"`: 라인이 없음 → 찾아야 함

- `read_distance()`: 앞의 거리를 측정 (cm 단위)
- `is_obstacle_close()`: 장애물이 가까이 있는지 확인

#### 💡 사용 예시
```python
from simple_sensors import read_line, read_distance

line_position = read_line()
distance = read_distance()

print(f"라인 위치: {line_position}")
print(f"앞의 거리: {distance}cm")
```

### 🚗 simple_motors.py - 바퀴 움직이기

#### 🔧 주요 함수
- `go_forward(speed)`: 앞으로 가기
- `go_backward(speed)`: 뒤로 가기
- `turn_left(speed)`: 왼쪽으로 회전
- `turn_right(speed)`: 오른쪽으로 회전
- `turn_left_gentle(speed)`: 부드럽게 왼쪽으로
- `turn_right_gentle(speed)`: 부드럽게 오른쪽으로
- `stop()`: 멈춤

#### 🎛️ 속도 설정
```python
SPEED_SLOW = 30     # 느린 속도
SPEED_NORMAL = 50   # 보통 속도  
SPEED_FAST = 70     # 빠른 속도
```

#### 💡 사용 예시
```python
from simple_motors import go_forward, turn_left, stop

go_forward()        # 보통 속도로 직진
turn_left(30)       # 느린 속도로 좌회전
stop()              # 정지
```

### 🛣️ simple_line_follow.py - 라인 추적

#### 🧠 주요 함수
- `follow_line_simple()`: 기본 라인 추적
- `follow_line_smooth()`: 부드러운 라인 추적 (추천)
- `start_line_following(smooth_mode, duration)`: 라인 추적 시작

#### 🔄 동작 원리
```
센서가 라인 위치 확인 → 자동차 방향 조절
┌─────────────┬─────────────┬─────────────┐
│ 라인이 왼쪽  │ 라인이 가운데 │ 라인이 오른쪽 │
│ → 오른쪽 회전│ → 직진       │ → 왼쪽 회전  │
└─────────────┴─────────────┴─────────────┘
```

### 🛡️ simple_obstacle_avoid.py - 장애물 회피

#### 🚨 주요 함수
- `check_obstacle()`: 장애물 위험도 확인
  - `"safe"`: 안전함 (30cm 이상)
  - `"warning"`: 주의 (15-30cm)
  - `"danger"`: 위험함 (15cm 이하)

- `avoid_obstacle_simple()`: 간단한 회피 (3단계)
  1. 왼쪽으로 돌기
  2. 앞으로 가기
  3. 오른쪽으로 돌기

#### ⚙️ 거리 설정
```python
SAFE_DISTANCE = 30      # 안전한 거리 (cm)
DANGER_DISTANCE = 15    # 위험한 거리 (cm)
AVOID_TIME = 0.8        # 회피 동작 시간 (초)
```

---

## ⚙️ 설정 변경하기

### 🏎️ 속도 조절
`simple_motors.py` 파일에서:
```python
SPEED_SLOW = 30     # 이 숫자를 바꾸세요 (10-100)
SPEED_NORMAL = 50   # 이 숫자를 바꾸세요 (10-100)
SPEED_FAST = 70     # 이 숫자를 바꾸세요 (10-100)
```

### 📏 장애물 감지 거리 조절
`simple_obstacle_avoid.py` 파일에서:
```python
SAFE_DISTANCE = 30      # 안전 거리 (클수록 멀리서 감지)
DANGER_DISTANCE = 15    # 위험 거리 (작을수록 가까워야 회피)
AVOID_TIME = 0.8        # 회피 시간 (클수록 오래 회피)
```

### 🌀 로터리 감지 설정 조절 (v3_improved)
`ultra_simple_car_v3_improved.py` 파일에서:
```python
ROTARY_CHECK_SAMPLES = 4              # 체크할 샘플 수 (4번 측정)
ROTARY_SAME_DIRECTION_THRESHOLD = 2   # 연속 감지 임계값 (2번 이상)
ROTARY_NON_CENTER_RATIO = 0.7        # 비중앙 비율 (70% 이상)
ROTARY_DURATION = 4.0                # 로터리 지속 시간 (4초)
```

**💡 로터리 설정 팁:**
- **연속 임계값↓**: 더 민감하게 감지 (2→1로 줄이면 더 빨리 감지)
- **비중앙 비율↓**: 더 자주 감지 (0.7→0.5로 줄이면 더 자주 감지)
- **샘플 수↑**: 더 정확하게 감지 (4→6으로 늘리면 더 안정적)
- **지속 시간↑**: 로터리에서 더 오래 안전 모드 (4→6초)

### 💡 설정 변경 팁
1. **처음에는 느린 속도로 시작**하세요 (SPEED_NORMAL = 30)
2. **안전 거리를 크게** 설정하세요 (SAFE_DISTANCE = 50)
3. 설정을 바꾼 후 **꼭 테스트**해보세요

---

## 🔧 문제 해결

### ❌ 자주 발생하는 문제들

#### 1. 프로그램이 실행되지 않아요
```bash
# 다음 명령어로 확인해보세요
python3 --version
ls simple_*.py
```

#### 2. 센서가 작동하지 않아요
- **시뮬레이션 모드**로 실행됩니다
- 실제 하드웨어 없이도 테스트 가능합니다
- 출력 메시지: `⚠️ 시뮬레이션 모드`

#### 3. 자동차가 너무 빨라요
- `simple_motors.py`에서 속도 값을 줄이세요
- `SPEED_NORMAL = 30` 정도로 시작

#### 4. 라인을 잘 못 따라가요
- 조명을 확인하세요 (너무 밝거나 어두우면 안됨)
- 검은 선이 충분히 진한지 확인하세요
- 부드러운 모드를 사용하세요 (`smooth_mode=True`)

#### 5. 장애물을 너무 늦게 피해요
- `SAFE_DISTANCE`를 더 크게 설정하세요
- `DANGER_DISTANCE`를 더 크게 설정하세요

#### 6. 로터리를 감지하지 못해요 (v3_improved)
- **연속 같은 방향 문제**: `ROTARY_SAME_DIRECTION_THRESHOLD = 1`로 줄이세요
- **민감도 부족**: `ROTARY_NON_CENTER_RATIO = 0.5`로 줄이세요  
- **샘플 부족**: `ROTARY_CHECK_SAMPLES = 6`으로 늘리세요
- **디버그 확인**: 실시간 분석 결과를 확인하세요

#### 7. 로터리를 너무 자주 감지해요 (v3_improved)
- **너무 민감함**: `ROTARY_SAME_DIRECTION_THRESHOLD = 3`으로 늘리세요
- **비중앙 비율 높임**: `ROTARY_NON_CENTER_RATIO = 0.8`로 늘리세요
- **지속 시간 줄임**: `ROTARY_DURATION = 2.0`으로 줄이세요

### 🆘 도움 받기
1. **프로그램 내 도움말**: 메뉴에서 6번 선택
2. **테스트 모드**: 각 기능을 안전하게 테스트
3. **수동 조종**: 3번 메뉴로 직접 확인

---

## 🚀 응용 프로젝트

### 🏁 레벨 1: 기본 프로젝트 (초보자)
- [ ] `ultra_simple_car.py`로 기본 동작 이해하기
- [ ] 속도를 다르게 설정해서 테스트해보기
- [ ] 장애물 감지 거리 바꿔보기
- [ ] v2_easy로 단계별 학습해보기

### 🏆 레벨 2: 중급 프로젝트 (교육자/학습자)
- [ ] v2_easy에서 단계별 시간 조정해보기 (15초→30초)
- [ ] LEFT/RIGHT 개별 모터 속도 실험해보기
- [ ] 장애물 회피 시간 조정해보기
- [ ] 다른 회피 패턴 만들어보기 (오른쪽으로 피하기)

### 🚀 레벨 3: 고급 프로젝트 (연구자)
- [ ] **v3_improved 로터리 알고리즘 분석하기**
- [ ] **연속 감지 임계값 최적화 실험하기**
- [ ] **비중앙 비율 조정 실험하기**
- [ ] **3중 검사 시스템 개선하기**
- [ ] 로그 파일로 분석 데이터 저장하기

### 🌟 레벨 4: 창의적 프로젝트
- [ ] **복합 로터리 감지 알고리즘 개발**
- [ ] **머신러닝 기반 라인 인식**
- [ ] **카메라 비전 추가**
- [ ] **다중 센서 융합**

### 💡 프로젝트 아이디어
1. **미로 탈출 로봇**: 벽을 따라가면서 출구 찾기
2. **청소 로봇**: 방 안을 체계적으로 움직이기
3. **순찰 로봇**: 정해진 경로를 반복해서 움직이기
4. **따라오는 로봇**: 장애물이 움직이면 따라가기

---

## 📖 참고 자료

### 🔗 관련 파일들
- `README.md`: 전체 프로젝트 설명
- `pinout.md`: 하드웨어 연결 정보
- `hardware/`: 실제 하드웨어 제어 파일들

### 📚 추가 학습
1. **Python 기초**: if문, for문, 함수
2. **하드웨어**: 라즈베리파이, 센서, 모터
3. **로봇공학**: PID 제어, 경로 계획
4. **컴퓨터비전**: 카메라로 라인 인식

---

## ❓ 자주 묻는 질문 (FAQ)

### Q1: 프로그래밍을 처음 배우는데 괜찮나요?
**A**: 네! 이 프로그램은 고등학생 수준에 맞춰 만들어졌습니다. Python 기초(if문, 함수)만 알면 충분합니다.

### Q2: 실제 로봇 없이도 사용할 수 있나요?
**A**: 네! 시뮬레이션 모드가 있어서 컴퓨터에서만으로도 모든 기능을 테스트할 수 있습니다.

### Q3: 어떤 부분을 먼저 공부해야 하나요?
**A**: 다음 순서를 추천합니다:
1. `simple_car.py` 실행해보기
2. `simple_sensors.py` 이해하기
3. `simple_motors.py` 이해하기
4. 설정값 바꿔보기

### Q4: 에러가 발생하면 어떻게 하나요?
**A**: 
1. 에러 메시지를 잘 읽어보세요
2. 시뮬레이션 모드인지 확인하세요
3. 파일 이름과 함수 이름을 다시 확인하세요

### Q5: 더 복잡한 기능을 추가하고 싶어요
**A**: 먼저 기본 기능을 완전히 이해한 후에, 한 번에 하나씩 기능을 추가해보세요. 작은 변화부터 시작하는 것이 좋습니다.

---

## 🎉 마무리

이 가이드를 통해 자율 주행차의 기본 원리를 이해하고, 직접 프로그래밍해볼 수 있기를 바랍니다!

**시작하는 것이 가장 중요합니다.** 처음에는 복잡해 보일 수 있지만, 하나씩 차근차근 따라해보면 금세 이해할 수 있을 거예요.

### 🌟 성공하는 팁
1. **작게 시작하기**: 전체를 한 번에 이해하려 하지 말고, 한 모듈씩
2. **많이 실험하기**: 설정값을 바꿔보고 결과를 관찰하기
3. **문제 해결하기**: 에러가 나도 포기하지 말고 차근차근 해결하기
4. **응용해보기**: 기본을 익힌 후 새로운 기능 추가해보기

**행운을 빕니다! 🚗💨**

---

## 🌟 특별 부록: v3_improved 로터리 감지 알고리즘

### 🧠 **3중 검사 시스템**

#### 1️⃣ **연속 감지 (새로운!)**
```python
# 문제: 연속 왼쪽 감지 못함
샘플: [left, left, left, left] → 변화율 0% ❌

# 해결: 연속 감지 추가  
연속 left 2번 이상 → 로터리 감지! ✅
```

#### 2️⃣ **비중앙 비율 (새로운!)**  
```python
# 로터리 특성: center가 적음
4번 중 center가 아닌 것이 70% 이상 → 로터리 감지! ✅
```

#### 3️⃣ **변화율 (기존 개선)**
```python
# 기존 방식 유지하면서 개선
4번 중 변화가 60% 이상 → 로터리 감지! ✅
```

### 📊 **실시간 분석 출력**
```
📊 로터리 분석:
   연속: 2회 left ⚠️     ← 임계값 달성!
   비중앙: 3/4 = 0.75 ⚠️  ← 75% 비중앙!  
   변화: 2/3 = 0.67      ← 67% 변화

🌀 로터리 감지! 사유: 연속 left 2회
```

### ⚙️ **사용자 설정값 (조정됨)**
- `ROTARY_CHECK_SAMPLES = 4` (8→4로 줄여서 빠른 반응)
- `ROTARY_SAME_DIRECTION_THRESHOLD = 2` (4→2로 줄여서 민감한 감지)
- `ROTARY_NON_CENTER_RATIO = 0.7` (70% 비중앙 비율 유지)
- `ROTARY_DURATION = 4.0` (4초 안전 모드 유지)

### 🎯 **해결된 문제들**
- ✅ **연속 왼쪽 걸림** → 연속 감지로 해결
- ✅ **연속 오른쪽 걸림** → 연속 감지로 해결
- ✅ **넓은 라인 대응** → 비중앙 비율로 해결
- ✅ **복잡한 로터리** → 3중 검사로 확실한 감지
- ✅ **오탐지 방지** → 3가지 조건으로 정확성 향상

이제 **어떤 로터리 상황**에서도 확실하게 감지합니다! 🌀✨

---
*📝 이 가이드는 계속 업데이트됩니다. 질문이나 개선사항이 있으면 언제든 말씀해주세요!*
